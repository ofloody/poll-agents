version: 1.0
runtime: python311
build:
  commands:
    build:
      - pip install -e ".[supabase]"
run:
  command: poll-agents
  network:
    port: 8080
  env:
    - name: SERVER_HOST
      value: "0.0.0.0"
    - name: SERVER_PORT
      value: "8765"
    - name: SERVER_HEALTH_PORT
      value: "8080"
    - name: SMTP_HOST
      value: "smtp.gmail.com"
    - name: SMTP_PORT
      value: "587"
    - name: SMTP_USE_TLS
      value: "true"
  secrets:
    - name: SUPABASE_URL
      value-from: "arn:aws:secretsmanager:us-east-2:450788529886:secret:poll-agents/supabase-url-uUueNT"
    - name: SUPABASE_KEY
      value-from: "arn:aws:secretsmanager:us-east-2:450788529886:secret:poll-agents/supabase-key-oiHfAi"
    - name: SMTP_USERNAME
      value-from: "arn:aws:secretsmanager:us-east-2:450788529886:secret:poll-agents/smtp-username-bI73tI"
    - name: SMTP_PASSWORD
      value-from: "arn:aws:secretsmanager:us-east-2:450788529886:secret:poll-agents/smtp-password-aKVu4I"
    - name: SMTP_SENDER_EMAIL
      value-from: "arn:aws:secretsmanager:us-east-2:450788529886:secret:poll-agents/smtp-sender-email-qCP7zk"
